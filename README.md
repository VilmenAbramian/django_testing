# Django testing  
Данный репозиторий содержит два Django-проекта: YaNews и YaNote, которые представляют из себя сервисы размещения новостей и заметок. По структуре и функционалу они схожи с другим моим проектом - Blogicum. В данном случае проекты в этом репозитории представляли собой прекод, для которого нужно было написать тесты. Для YaNews с использованием библиотеки pytest, для YaNote - на Unittest.

## Для активации тестов требуется:
1. Создать и активировать виртуальное окружение; установить зависимости из файла `requirements.txt`;
2. Запустить скрипт для `run_tests.sh` из корневой директории проекта:
```sh
bash run_tests.sh
```

Структура репозитория:
```
 django_testing
     ├── ya_news
     │   ├── news
     │   │   ├── fixtures/
     │   │   ├── migrations/
     │   │   ├── pytest_tests/
     |   │   │   ├── __init__.py
     |   │   │   ├── conftest.py <- Модуль с фикстурами
     |   │   │   ├── consts.py <- Модуль с рассчитанными адресами и пользователями
     |   │   │   ├── test_content.py <- Модуль с тестами содержимого страниц
     |   │   │   ├── test_logic.py <- Модуль с тестами логики работы сервиса
     |   │   │   └── test_routes.py <- Модуль с тестами маршрутов сайта
     │   │   ├── __init__.py
     │   │   ├── admin.py
     │   │   ├── apps.py
     │   │   ├── forms.py
     │   │   ├── models.py
     │   │   ├── urls.py
     │   │   └── views.py
     │   ├── templates/
     │   ├── yanews/
     │   ├── manage.py
     │   └── pytest.ini
     ├── ya_note
     │   ├── notes
     │   │   ├── migrations/
     │   │   ├── tests/
     |   │   │   ├── __init__.py
     |   │   │   ├── conf.py <- Модуль с фикстурами
     |   │   │   ├── consts.py <- Модуль с рассчитанными адресами и пользователями
     |   │   │   ├── test_content.py <- Модуль с тестами содержимого страниц
     |   │   │   ├── test_logic.py <- Модуль с тестами логики работы сервиса
     |   │   │   └── test_routes.py <- Модуль с тестами маршрутов сайта
     │   │   ├── __init__.py
     │   │   ├── admin.py
     │   │   ├── apps.py
     │   │   ├── forms.py
     │   │   ├── models.py
     │   │   ├── urls.py
     │   │   └── views.py
     │   ├── templates/
     │   ├── yanote/
     │   ├── manage.py
     │   └── pytest.ini
     ├── .gitignore
     ├── README.md
     ├── requirements.txt
     └── structure_test.py
```
Пакет тестов на Pytest (для проекта YaNews) включает следующие модули:
* Файл conftest.py содержит фикстуры создания различных пользователей и объектов (таких как набор новостных записей, одну новостную запись, набор комментариев, один комментарий), а также фикстуры, рассчитывающие адреса до разных страниц сайта.
* Файл consts.py собирает требуемые для параметризации тестов фикстуры в классы с набором констант. Для того, чтобы была возможность передавать фикстуры в параметры тестов применена библиотека lazy_fixture.
* Модуль test_content.py содержит следующие тесты:
  -   Количество новостей на главной странице — не более 10.
  -   Новости отсортированы от самой свежей к самой старой. Свежие новости в начале списка.
  -   Комментарии на странице отдельной новости отсортированы в хронологическом порядке: старые в начале списка, новые — в конце.
  -   Анонимному пользователю недоступна форма для отправки комментария на странице отдельной новости, а авторизованному доступна. 
*  Модуль test_logic.py содержит следующие тесты:
   -    Анонимный пользователь не может отправить комментарий.
   -    Авторизованный пользователь может отправить комментарий.
   -    Если комментарий содержит запрещённые слова, он не будет опубликован, а форма вернёт ошибку.
   -   Авторизованный пользователь может редактировать или удалять свои комментарии.
   -   Авторизованный пользователь не может редактировать или удалять чужие комментарии.
  *  Модуль test_routes.py содержит следующие тесты:
     -   Главная страница доступна анонимному пользователю.
     -   Страница отдельной новости доступна анонимному пользователю.
     -   Страницы удаления и редактирования комментария доступны автору комментария.
     -   При попытке перейти на страницу редактирования или удаления комментария анонимный пользователь перенаправляется на страницу авторизации.
     -   Авторизованный пользователь не может зайти на страницы редактирования или удаления чужих комментариев (возвращается ошибка 404).
     -   Страницы регистрации пользователей, входа в учётную запись и выхода из неё доступны анонимным пользователям.

Пакет тестов на Unittest (для проекта YaNote) включает следующие модули:
* Файл conf.py содержит родительский класс с фикстурами создания различных пользователей и заметки, а также фикстуры, рассчитывающие адреса до разных страниц сайта.
* Модуль test_content.py содержит следующие тесты:
  -   отдельная заметка передаётся на страницу со списком заметок в списке `object_list` в словаре `context`;
  -   в список заметок одного пользователя не попадают заметки другого пользователя;
  -   на страницы создания и редактирования заметки передаются формы.
*  Модуль test_logic.py содержит следующие тесты:
   -   Залогиненный пользователь может создать заметку, а анонимный — не может.
   -   Невозможно создать две заметки с одинаковым slug.
   -   Если при создании заметки не заполнен slug, то он формируется автоматически, с помощью функции `pytils.translit.slugify`.
   -   Пользователь может редактировать и удалять свои заметки, но не может редактировать или удалять чужие.
  *  Модуль test_routes.py содержит следующие тесты:
     -   Главная страница доступна анонимному пользователю.
     -   Страница отдельной новости доступна анонимному пользователю.
     -   Страницы удаления и редактирования комментария доступны автору комментария.
     -   При попытке перейти на страницу редактирования или удаления комментария анонимный пользователь перенаправляется на страницу авторизации.
     -   Авторизованный пользователь не может зайти на страницы редактирования или удаления чужих комментариев (возвращается ошибка 404).
     -   Страницы регистрации пользователей, входа в учётную запись и выхода из неё доступны анонимным пользователям.

Проект 9го спринта курса Python разработчик +
